"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.1.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fsaadbadr%2FDocuments%2FWeb%2Fbrandenburg-dialog-web%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsaadbadr%2FDocuments%2FWeb%2Fbrandenburg-dialog-web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.1.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fsaadbadr%2FDocuments%2FWeb%2Fbrandenburg-dialog-web%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsaadbadr%2FDocuments%2FWeb%2Fbrandenburg-dialog-web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.1.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.1.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@14.1.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_saadbadr_Documents_Web_brandenburg_dialog_web_src_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/chat/route.ts */ \"(rsc)/./src/app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/saadbadr/Documents/Web/brandenburg-dialog-web/src/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_saadbadr_Documents_Web_brandenburg_dialog_web_src_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4xLjBfcmVhY3QtZG9tQDE4LjMuMV9yZWFjdEAxOC4zLjFfX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnNhYWRiYWRyJTJGRG9jdW1lbnRzJTJGV2ViJTJGYnJhbmRlbmJ1cmctZGlhbG9nLXdlYiUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZzYWFkYmFkciUyRkRvY3VtZW50cyUyRldlYiUyRmJyYW5kZW5idXJnLWRpYWxvZy13ZWImaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDOEI7QUFDM0c7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZW1wLW5leHQvP2YyYjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL3NhYWRiYWRyL0RvY3VtZW50cy9XZWIvYnJhbmRlbmJ1cmctZGlhbG9nLXdlYi9zcmMvYXBwL2FwaS9jaGF0L3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jaGF0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2hhdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2hhdC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9zYWFkYmFkci9Eb2N1bWVudHMvV2ViL2JyYW5kZW5idXJnLWRpYWxvZy13ZWIvc3JjL2FwcC9hcGkvY2hhdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jaGF0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.1.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fsaadbadr%2FDocuments%2FWeb%2Fbrandenburg-dialog-web%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsaadbadr%2FDocuments%2FWeb%2Fbrandenburg-dialog-web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/chat/route.ts":
/*!***********************************!*\
  !*** ./src/app/api/chat/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/.pnpm/next@14.1.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db.ts\");\n\n\nconst FLOWISE_URL = \"https://flowise-smg.onrender.com\" || 0;\nconst DEFAULT_FLOWISE_CHATFLOW_ID = process.env.FLOWISE_CHATFLOW_ID;\nconst FLOWISE_API_KEY = process.env.FLOWISE_API_KEY;\n// API DEBUG VERSION 004\nconsole.log(\"CHAT-API-DEBUG-004: API Route geladen\");\nconsole.log(\"CHAT-API-DEBUG-004: FLOWISE_URL:\", FLOWISE_URL);\nconsole.log(\"CHAT-API-DEBUG-004: DEFAULT_FLOWISE_CHATFLOW_ID:\", DEFAULT_FLOWISE_CHATFLOW_ID ? \"vorhanden\" : \"FEHLT\");\n// FALLBACK-ANTWORTEN für den Fall, dass die API nicht erreichbar ist\nconst FALLBACK_RESPONSES = [\n    \"Entschuldigung, ich kann im Moment leider nicht auf Ihre Anfrage antworten. Bitte versuchen Sie es sp\\xe4ter noch einmal.\",\n    \"Es tut mir leid, aber ich habe momentan Probleme, eine Antwort zu generieren. Bitte versuchen Sie es sp\\xe4ter erneut.\",\n    \"Leider kann ich Ihre Anfrage derzeit nicht bearbeiten. Bitte versuchen Sie es sp\\xe4ter noch einmal oder wenden Sie sich direkt an die Stadtverwaltung.\"\n];\nasync function POST(request) {\n    console.log(\"CHAT-API-DEBUG-004: POST-Anfrage erhalten\");\n    try {\n        const body = await request.json();\n        console.log(\"CHAT-API-DEBUG-004: Request-Body:\", JSON.stringify(body));\n        // Extrahiere die letzte Benutzernachricht für die Weiterverarbeitung\n        let userQuestion = \"\";\n        if (body.messages && body.messages.length > 0) {\n            const lastUserMessage = [\n                ...body.messages\n            ].reverse().find((m)=>m.role === \"user\");\n            if (lastUserMessage) {\n                userQuestion = lastUserMessage.content;\n            }\n        } else if (body.message) {\n            userQuestion = body.message;\n        }\n        // SPEZIALFALL: \"Wer bist du?\" und ähnliche Identitätsfragen\n        const identityQuestions = [\n            \"wer bist du\",\n            \"was bist du\",\n            \"stell dich vor\",\n            \"wie hei\\xdft du\",\n            \"was kannst du\"\n        ];\n        // Überprüfe, ob die Frage eine Identitätsfrage ist (case insensitive)\n        const normalizedQuestion = userQuestion.toLowerCase().trim();\n        const isIdentityQuestion = identityQuestions.some((q)=>normalizedQuestion.includes(q));\n        // Behandle sowohl einzelne Nachrichten als auch Nachrichtenverläufe\n        const message = body.message;\n        const messages = body.messages;\n        // Wir ignorieren den streaming-Parameter und setzen immer streaming=false\n        const streaming = false;\n        if (!message && (!messages || messages.length === 0)) {\n            console.error(\"CHAT-API-DEBUG-004: Keine Nachricht gefunden\");\n            // FALLBACK: Sende eine freundliche Fehlermeldung zurück\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                text: \"Entschuldigung, ich habe keine Frage erhalten. Wie kann ich Ihnen helfen?\",\n                error: \"Keine Nachricht gefunden\"\n            });\n        }\n        // Ermittle die zu verwendende Flowise-Chatflow-ID\n        // Wenn eine botId angegeben ist, verwende die Chatflow-ID dieses Bots\n        let flowiseId = DEFAULT_FLOWISE_CHATFLOW_ID;\n        let bot = null;\n        let botSettings = null;\n        if (body.botId) {\n            try {\n                bot = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bot.findUnique({\n                    where: {\n                        id: body.botId\n                    },\n                    include: {\n                        settings: true\n                    }\n                });\n                if (bot) {\n                    flowiseId = bot.flowiseId;\n                    botSettings = bot.settings;\n                    console.log(`CHAT-API-DEBUG-004: Verwende Chatflow-ID von Bot \"${bot.name}\": ${flowiseId}`);\n                } else {\n                    console.warn(`CHAT-API-DEBUG-004: Bot mit ID ${body.botId} nicht gefunden, verwende Standard-Chatflow`);\n                }\n            } catch (dbError) {\n                console.error(\"CHAT-API-DEBUG-004: Datenbankfehler bei Bot-Abfrage:\", dbError);\n            }\n        } else {\n            // Wenn keine botId angegeben ist, aber ein aktiver Standard-Bot existiert\n            try {\n                bot = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].bot.findFirst({\n                    where: {\n                        active: true\n                    },\n                    include: {\n                        settings: true\n                    },\n                    orderBy: {\n                        createdAt: \"asc\"\n                    }\n                });\n                if (bot) {\n                    flowiseId = bot.flowiseId;\n                    botSettings = bot.settings;\n                    console.log(`CHAT-API-DEBUG-004: Verwende Chatflow-ID vom Standard-Bot \"${bot.name}\": ${flowiseId}`);\n                }\n            } catch (dbError) {\n                console.error(\"CHAT-API-DEBUG-004: Datenbankfehler bei Standard-Bot-Abfrage:\", dbError);\n            }\n        }\n        // Für Identitätsfragen generiere eine direkte Antwort basierend auf den Bot-Einstellungen\n        if (isIdentityQuestion && botSettings) {\n            console.log(\"CHAT-API-DEBUG-004: Identit\\xe4tsfrage erkannt, generiere direkte Antwort\");\n            const botPersonality = botSettings.botPersonality || \"Du bist der Assistent des Einkaufscenters ORO Schwabach\";\n            const botContext = botSettings.botContext || \"Center\";\n            const botScope = botSettings.botScope || \"das Center, die Shops und die Produkte\";\n            // Generiere eine personalisierte Antwort basierend auf den Bot-Einstellungen\n            let botAnswer = `Ich bin ein digitaler Assistent für das ${botContext} 🤖. Ich helfe dir gerne bei Fragen rund um ${botScope}! 😊`;\n            // Zusätzliche Informationen basierend auf der spezifischen Frage\n            if (normalizedQuestion.includes(\"was kannst du\")) {\n                botAnswer += ` Ich kann dir Informationen zu Öffnungszeiten, Shops, Angeboten und vielem mehr geben. Frag mich einfach! 📝`;\n            }\n            console.log(\"CHAT-API-DEBUG-004: Benutzerdefinierte Antwort:\", botAnswer);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                text: botAnswer,\n                question: userQuestion\n            });\n        }\n        // Prüfe ob eine Chatflow-ID verfügbar ist\n        if (!flowiseId) {\n            console.error(\"CHAT-API-DEBUG-004: Keine Flowise-Chatflow-ID verf\\xfcgbar\");\n            // FALLBACK: Sende eine Standardantwort zurück\n            const randomIndex = Math.floor(Math.random() * FALLBACK_RESPONSES.length);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                text: FALLBACK_RESPONSES[randomIndex],\n                error: \"Keine Flowise-Chatflow-ID verf\\xfcgbar\"\n            });\n        }\n        const apiUrl = `${FLOWISE_URL}/api/v1/prediction/${flowiseId}`;\n        console.log(\"CHAT-API-DEBUG-004: Flowise API URL:\", apiUrl);\n        // Verbesserte Anfrage-Struktur basierend auf der Flowise API-Dokumentation\n        let requestBody;\n        if (messages && messages.length > 0) {\n            // Extrahiere die letzte Benutzernachricht aus dem messages-Array\n            const lastUserMessage = [\n                ...messages\n            ].reverse().find((m)=>m.role === \"user\");\n            if (lastUserMessage) {\n                console.log(\"CHAT-API-DEBUG-004: Letzte Benutzernachricht gefunden:\", lastUserMessage.content);\n                // Formatiere messages für Flowise API\n                const history = messages.filter((m)=>m !== lastUserMessage) // Alle Nachrichten außer der letzten Benutzernachricht\n                .map((m)=>({\n                        role: m.role === \"assistant\" ? \"apiMessage\" : \"userMessage\",\n                        content: m.content\n                    }));\n                requestBody = {\n                    question: lastUserMessage.content,\n                    history: history.length > 0 ? history : undefined,\n                    streaming: false\n                };\n                // Wenn Bot-Einstellungen verfügbar sind, füge overrideConfig hinzu\n                if (botSettings) {\n                    requestBody.overrideConfig = {\n                        botPersonality: botSettings.botPersonality || \"Du bist der Assistent des Einkaufscenters ORO Schwabach\",\n                        botContext: botSettings.botContext || \"Center\",\n                        botScope: botSettings.botScope || \"das Center, die Shops und die Produkte\",\n                        offerTip: botSettings.offerTip || \"Wenn du einen Shop findest in dem es ein Aktuelles Angebot bist, bietest du das Angebot als Tipp an.\",\n                        closedDays: botSettings.closedDays || \"\"\n                    };\n                    console.log(\"CHAT-API-DEBUG-004: overrideConfig hinzugef\\xfcgt:\", JSON.stringify(requestBody.overrideConfig));\n                }\n                console.log(\"CHAT-API-DEBUG-004: Nachrichtenverlauf mit\", history.length, \"Eintr\\xe4gen\");\n            } else {\n                console.error(\"CHAT-API-DEBUG-004: Keine Benutzernachricht im Verlauf gefunden\");\n                // FALLBACK: Sende eine Standardantwort zurück\n                const randomIndex = Math.floor(Math.random() * FALLBACK_RESPONSES.length);\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    text: FALLBACK_RESPONSES[randomIndex],\n                    error: \"Keine Benutzernachricht im Verlauf gefunden\"\n                });\n            }\n        } else {\n            // Einzelne Nachricht verwenden\n            requestBody = {\n                question: message,\n                streaming: false\n            };\n            // Wenn Bot-Einstellungen verfügbar sind, füge overrideConfig hinzu\n            if (botSettings) {\n                requestBody.overrideConfig = {\n                    botPersonality: botSettings.botPersonality || \"Du bist der Assistent des Einkaufscenters ORO Schwabach\",\n                    botContext: botSettings.botContext || \"Center\",\n                    botScope: botSettings.botScope || \"das Center, die Shops und die Produkte\",\n                    offerTip: botSettings.offerTip || \"Wenn du einen Shop findest in dem es ein Aktuelles Angebot bist, bietest du das Angebot als Tipp an.\",\n                    closedDays: botSettings.closedDays || \"\"\n                };\n                console.log(\"CHAT-API-DEBUG-004: overrideConfig hinzugef\\xfcgt:\", JSON.stringify(requestBody.overrideConfig));\n            }\n            console.log(\"CHAT-API-DEBUG-004: Einzelnachricht wird verwendet:\", message);\n        }\n        console.log(\"CHAT-API-DEBUG-004: Flowise API Anfrage:\", apiUrl);\n        console.log(\"CHAT-API-DEBUG-004: Request Body:\", JSON.stringify(requestBody));\n        try {\n            console.log(\"CHAT-API-DEBUG-004: Starte Fetch zu Flowise...\");\n            // Setze ein Timeout für die Anfrage\n            const controller = new AbortController();\n            const timeoutId = setTimeout(()=>controller.abort(), 15000); // Auf 15 Sekunden erhöht, da Flowise manchmal länger braucht\n            const headers = {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": FLOWISE_API_KEY ? `Bearer ${FLOWISE_API_KEY}` : \"\"\n            };\n            // Füge einen speziellen Header hinzu, um die Rohformatierung in Flowise zu erhalten\n            // Dies hilft, die identische Formatierung wie in der Flowise-Oberfläche zu erhalten\n            const response = await fetch(apiUrl, {\n                method: \"POST\",\n                headers,\n                body: JSON.stringify(requestBody),\n                signal: controller.signal\n            });\n            // Timeout entfernen, da die Anfrage abgeschlossen ist\n            clearTimeout(timeoutId);\n            console.log(\"CHAT-API-DEBUG-004: Flowise API Antwort Status:\", response.status);\n            if (!response.ok) {\n                const errorData = await response.text();\n                console.error(\"CHAT-API-DEBUG-004: Flowise API Fehler:\", response.status, errorData);\n                // FALLBACK: Sende eine Standardantwort zurück\n                const randomIndex = Math.floor(Math.random() * FALLBACK_RESPONSES.length);\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    text: FALLBACK_RESPONSES[randomIndex],\n                    error: `API-Fehler: ${response.status}`\n                });\n            }\n            // Bei normaler Antwort das JSON zurückgeben\n            const data = await response.json();\n            console.log(\"CHAT-API-DEBUG-004: Flowise API Antwort erhalten:\", typeof data, data ? Object.keys(data) : \"Keine Daten\");\n            // Direkt die Antwort von Flowise zurückgeben ohne Modifikationen\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(data);\n        } catch (fetchError) {\n            console.error(\"CHAT-API-DEBUG-004: Fetch-Fehler bei Flowise-Anfrage:\", fetchError);\n            // FALLBACK: Wenn der Fetch fehlgeschlagen ist, sende eine Standardantwort zurück\n            const randomIndex = Math.floor(Math.random() * FALLBACK_RESPONSES.length);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                text: FALLBACK_RESPONSES[randomIndex],\n                question: userQuestion,\n                error: fetchError instanceof Error ? fetchError.message : \"Unbekannter Fetch-Fehler\"\n            });\n        }\n    } catch (error) {\n        console.error(\"CHAT-API-DEBUG-004: Chat API Fehler:\", error);\n        // FALLBACK: Sende eine Standardantwort zurück\n        const randomIndex = Math.floor(Math.random() * FALLBACK_RESPONSES.length);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            text: FALLBACK_RESPONSES[randomIndex],\n            error: error instanceof Error ? error.message : \"Ein unbekannter Fehler ist aufgetreten\"\n        }, {\n            status: 200\n        }) // Wichtig: Status 200 zurückgeben, um Frontend-Fehler zu vermeiden\n        ;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxPQUFPQyxJQUFJLENBQUNGLFFBQVE7WUFFcEQsaUVBQWlFO1lBQ2pFLE9BQU92RixrRkFBWUEsQ0FBQ2UsSUFBSSxDQUFDd0U7UUFDM0IsRUFBRSxPQUFPRyxZQUFZO1lBQ25CakYsUUFBUTRCLEtBQUssQ0FBQyx5REFBeURxRDtZQUV2RSxpRkFBaUY7WUFDakYsTUFBTTlCLGNBQWNDLEtBQUtDLEtBQUssQ0FBQ0QsS0FBS0UsTUFBTSxLQUFLcEQsbUJBQW1CUyxNQUFNO1lBQ3hFLE9BQU9wQixrRkFBWUEsQ0FBQ2UsSUFBSSxDQUFDO2dCQUN2QnVCLE1BQU0zQixrQkFBa0IsQ0FBQ2lELFlBQVk7Z0JBQ3JDRCxVQUFVekM7Z0JBQ1ZtQixPQUFPcUQsc0JBQXNCQyxRQUFRRCxXQUFXL0QsT0FBTyxHQUFHO1lBQzVEO1FBQ0Y7SUFDRixFQUFFLE9BQU9VLE9BQU87UUFDZDVCLFFBQVE0QixLQUFLLENBQUMsd0NBQXdDQTtRQUV0RCw4Q0FBOEM7UUFDOUMsTUFBTXVCLGNBQWNDLEtBQUtDLEtBQUssQ0FBQ0QsS0FBS0UsTUFBTSxLQUFLcEQsbUJBQW1CUyxNQUFNO1FBQ3hFLE9BQU9wQixrRkFBWUEsQ0FBQ2UsSUFBSSxDQUFDO1lBQ3ZCdUIsTUFBTTNCLGtCQUFrQixDQUFDaUQsWUFBWTtZQUNyQ3ZCLE9BQU9BLGlCQUFpQnNELFFBQVF0RCxNQUFNVixPQUFPLEdBQUc7UUFDbEQsR0FBRztZQUFFeUQsUUFBUTtRQUFJLEdBQUcsbUVBQW1FOztJQUN6RjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVtcC1uZXh0Ly4vc3JjL2FwcC9hcGkvY2hhdC9yb3V0ZS50cz80NmI3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHByaXNtYSBmcm9tICdAL2xpYi9kYidcbmltcG9ydCB7IEJvdFNldHRpbmdzIH0gZnJvbSAnQC90eXBlcy9ib3QnXG5cbmNvbnN0IEZMT1dJU0VfVVJMID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRkxPV0lTRV9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCdcbmNvbnN0IERFRkFVTFRfRkxPV0lTRV9DSEFURkxPV19JRCA9IHByb2Nlc3MuZW52LkZMT1dJU0VfQ0hBVEZMT1dfSURcbmNvbnN0IEZMT1dJU0VfQVBJX0tFWSA9IHByb2Nlc3MuZW52LkZMT1dJU0VfQVBJX0tFWVxuXG4vLyBBUEkgREVCVUcgVkVSU0lPTiAwMDRcbmNvbnNvbGUubG9nKFwiQ0hBVC1BUEktREVCVUctMDA0OiBBUEkgUm91dGUgZ2VsYWRlblwiKTtcbmNvbnNvbGUubG9nKFwiQ0hBVC1BUEktREVCVUctMDA0OiBGTE9XSVNFX1VSTDpcIiwgRkxPV0lTRV9VUkwpO1xuY29uc29sZS5sb2coXCJDSEFULUFQSS1ERUJVRy0wMDQ6IERFRkFVTFRfRkxPV0lTRV9DSEFURkxPV19JRDpcIiwgREVGQVVMVF9GTE9XSVNFX0NIQVRGTE9XX0lEID8gXCJ2b3JoYW5kZW5cIiA6IFwiRkVITFRcIik7XG5cbi8vIERlZmluaWVyZSBkaWUgVHlwZW4gZsO8ciBOYWNocmljaHRlblxuaW50ZXJmYWNlIE1lc3NhZ2Uge1xuICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgY29udGVudDogc3RyaW5nO1xufVxuXG4vLyBEZWZpbmllcmUgZGllIFR5cGVuIGbDvHIgRmxvd2lzZS1zcGV6aWZpc2NoZSBOYWNocmljaHRlblxuaW50ZXJmYWNlIEZsb3dpc2VNZXNzYWdlIHtcbiAgcm9sZTogJ2FwaU1lc3NhZ2UnIHwgJ3VzZXJNZXNzYWdlJztcbiAgY29udGVudDogc3RyaW5nO1xufVxuXG4vLyBEZWZpbmllcmUgZGVuIFR5cCBmw7xyIGRpZSBGbG93aXNlLUFuZnJhZ2VcbmludGVyZmFjZSBGbG93aXNlUmVxdWVzdEJvZHkge1xuICBxdWVzdGlvbjogc3RyaW5nO1xuICBoaXN0b3J5PzogRmxvd2lzZU1lc3NhZ2VbXTtcbiAgc3RyZWFtaW5nOiBib29sZWFuO1xuICBvdmVycmlkZUNvbmZpZz86IHtcbiAgICBib3RQZXJzb25hbGl0eT86IHN0cmluZztcbiAgICBib3RDb250ZXh0Pzogc3RyaW5nO1xuICAgIGJvdFNjb3BlPzogc3RyaW5nO1xuICAgIG9mZmVyVGlwPzogc3RyaW5nO1xuICAgIGNsb3NlZERheXM/OiBzdHJpbmc7XG4gICAgW2tleTogc3RyaW5nXTogYW55O1xuICB9O1xufVxuXG4vLyBFcndlaXRlcmUgQm90U2V0dGluZ3MgZsO8ciBkaWUgQVBJXG5pbnRlcmZhY2UgQm90U2V0dGluZ3NXaXRoUHJvbXB0IHtcbiAgLy8gU3RhbmRhcmQgQm90U2V0dGluZ3MgRmVsZGVyXG4gIHByaW1hcnlDb2xvcjogc3RyaW5nO1xuICBib3RCZ0NvbG9yOiBzdHJpbmc7XG4gIGJvdFRleHRDb2xvcjogc3RyaW5nO1xuICBib3RBY2NlbnRDb2xvcjogc3RyaW5nO1xuICB1c2VyQmdDb2xvcj86IHN0cmluZztcbiAgdXNlclRleHRDb2xvcjogc3RyaW5nO1xuICBlbmFibGVGZWVkYmFjazogYm9vbGVhbjtcbiAgZW5hYmxlQW5hbHl0aWNzOiBib29sZWFuO1xuICBzaG93U3VnZ2VzdGlvbnM6IGJvb2xlYW47XG4gIHNob3dDb3B5QnV0dG9uOiBib29sZWFuO1xuICBcbiAgLy8gRXJ3ZWl0ZXJ0ZSBGZWxkZXIgZsO8ciBQcm9tcHQtQW5wYXNzdW5nZW5cbiAgYm90UGVyc29uYWxpdHk/OiBzdHJpbmc7XG4gIGJvdENvbnRleHQ/OiBzdHJpbmc7XG4gIGJvdFNjb3BlPzogc3RyaW5nO1xuICBvZmZlclRpcD86IHN0cmluZztcbiAgY2xvc2VkRGF5cz86IHN0cmluZztcbn1cblxuLy8gRkFMTEJBQ0stQU5UV09SVEVOIGbDvHIgZGVuIEZhbGwsIGRhc3MgZGllIEFQSSBuaWNodCBlcnJlaWNoYmFyIGlzdFxuY29uc3QgRkFMTEJBQ0tfUkVTUE9OU0VTID0gW1xuICBcIkVudHNjaHVsZGlndW5nLCBpY2gga2FubiBpbSBNb21lbnQgbGVpZGVyIG5pY2h0IGF1ZiBJaHJlIEFuZnJhZ2UgYW50d29ydGVuLiBCaXR0ZSB2ZXJzdWNoZW4gU2llIGVzIHNww6R0ZXIgbm9jaCBlaW5tYWwuXCIsXG4gIFwiRXMgdHV0IG1pciBsZWlkLCBhYmVyIGljaCBoYWJlIG1vbWVudGFuIFByb2JsZW1lLCBlaW5lIEFudHdvcnQgenUgZ2VuZXJpZXJlbi4gQml0dGUgdmVyc3VjaGVuIFNpZSBlcyBzcMOkdGVyIGVybmV1dC5cIixcbiAgXCJMZWlkZXIga2FubiBpY2ggSWhyZSBBbmZyYWdlIGRlcnplaXQgbmljaHQgYmVhcmJlaXRlbi4gQml0dGUgdmVyc3VjaGVuIFNpZSBlcyBzcMOkdGVyIG5vY2ggZWlubWFsIG9kZXIgd2VuZGVuIFNpZSBzaWNoIGRpcmVrdCBhbiBkaWUgU3RhZHR2ZXJ3YWx0dW5nLlwiXG5dO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gIGNvbnNvbGUubG9nKFwiQ0hBVC1BUEktREVCVUctMDA0OiBQT1NULUFuZnJhZ2UgZXJoYWx0ZW5cIik7XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnNvbGUubG9nKFwiQ0hBVC1BUEktREVCVUctMDA0OiBSZXF1ZXN0LUJvZHk6XCIsIEpTT04uc3RyaW5naWZ5KGJvZHkpKTtcbiAgICBcbiAgICAvLyBFeHRyYWhpZXJlIGRpZSBsZXR6dGUgQmVudXR6ZXJuYWNocmljaHQgZsO8ciBkaWUgV2VpdGVydmVyYXJiZWl0dW5nXG4gICAgbGV0IHVzZXJRdWVzdGlvbiA9IFwiXCI7XG4gICAgaWYgKGJvZHkubWVzc2FnZXMgJiYgYm9keS5tZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBsYXN0VXNlck1lc3NhZ2UgPSBbLi4uYm9keS5tZXNzYWdlc10ucmV2ZXJzZSgpLmZpbmQobSA9PiBtLnJvbGUgPT09ICd1c2VyJyk7XG4gICAgICBpZiAobGFzdFVzZXJNZXNzYWdlKSB7XG4gICAgICAgIHVzZXJRdWVzdGlvbiA9IGxhc3RVc2VyTWVzc2FnZS5jb250ZW50O1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoYm9keS5tZXNzYWdlKSB7XG4gICAgICB1c2VyUXVlc3Rpb24gPSBib2R5Lm1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLy8gU1BFWklBTEZBTEw6IFwiV2VyIGJpc3QgZHU/XCIgdW5kIMOkaG5saWNoZSBJZGVudGl0w6R0c2ZyYWdlblxuICAgIGNvbnN0IGlkZW50aXR5UXVlc3Rpb25zID0gW1xuICAgICAgXCJ3ZXIgYmlzdCBkdVwiLFxuICAgICAgXCJ3YXMgYmlzdCBkdVwiLFxuICAgICAgXCJzdGVsbCBkaWNoIHZvclwiLFxuICAgICAgXCJ3aWUgaGVpw590IGR1XCIsXG4gICAgICBcIndhcyBrYW5uc3QgZHVcIlxuICAgIF07XG5cbiAgICAvLyDDnGJlcnByw7xmZSwgb2IgZGllIEZyYWdlIGVpbmUgSWRlbnRpdMOkdHNmcmFnZSBpc3QgKGNhc2UgaW5zZW5zaXRpdmUpXG4gICAgY29uc3Qgbm9ybWFsaXplZFF1ZXN0aW9uID0gdXNlclF1ZXN0aW9uLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgIGNvbnN0IGlzSWRlbnRpdHlRdWVzdGlvbiA9IGlkZW50aXR5UXVlc3Rpb25zLnNvbWUocSA9PiBub3JtYWxpemVkUXVlc3Rpb24uaW5jbHVkZXMocSkpO1xuXG4gICAgLy8gQmVoYW5kbGUgc293b2hsIGVpbnplbG5lIE5hY2hyaWNodGVuIGFscyBhdWNoIE5hY2hyaWNodGVudmVybMOkdWZlXG4gICAgY29uc3QgbWVzc2FnZSA9IGJvZHkubWVzc2FnZVxuICAgIGNvbnN0IG1lc3NhZ2VzOiBNZXNzYWdlW10gPSBib2R5Lm1lc3NhZ2VzXG4gICAgLy8gV2lyIGlnbm9yaWVyZW4gZGVuIHN0cmVhbWluZy1QYXJhbWV0ZXIgdW5kIHNldHplbiBpbW1lciBzdHJlYW1pbmc9ZmFsc2VcbiAgICBjb25zdCBzdHJlYW1pbmcgPSBmYWxzZVxuXG4gICAgaWYgKCFtZXNzYWdlICYmICghbWVzc2FnZXMgfHwgbWVzc2FnZXMubGVuZ3RoID09PSAwKSkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkNIQVQtQVBJLURFQlVHLTAwNDogS2VpbmUgTmFjaHJpY2h0IGdlZnVuZGVuXCIpO1xuICAgICAgXG4gICAgICAvLyBGQUxMQkFDSzogU2VuZGUgZWluZSBmcmV1bmRsaWNoZSBGZWhsZXJtZWxkdW5nIHp1csO8Y2tcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHRleHQ6IFwiRW50c2NodWxkaWd1bmcsIGljaCBoYWJlIGtlaW5lIEZyYWdlIGVyaGFsdGVuLiBXaWUga2FubiBpY2ggSWhuZW4gaGVsZmVuP1wiLFxuICAgICAgICBlcnJvcjogXCJLZWluZSBOYWNocmljaHQgZ2VmdW5kZW5cIlxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gRXJtaXR0bGUgZGllIHp1IHZlcndlbmRlbmRlIEZsb3dpc2UtQ2hhdGZsb3ctSURcbiAgICAvLyBXZW5uIGVpbmUgYm90SWQgYW5nZWdlYmVuIGlzdCwgdmVyd2VuZGUgZGllIENoYXRmbG93LUlEIGRpZXNlcyBCb3RzXG4gICAgbGV0IGZsb3dpc2VJZCA9IERFRkFVTFRfRkxPV0lTRV9DSEFURkxPV19JRDtcbiAgICBsZXQgYm90ID0gbnVsbDtcbiAgICBsZXQgYm90U2V0dGluZ3M6IEJvdFNldHRpbmdzV2l0aFByb21wdCB8IG51bGwgPSBudWxsO1xuICAgIFxuICAgIGlmIChib2R5LmJvdElkKSB7XG4gICAgICB0cnkge1xuICAgICAgICBib3QgPSBhd2FpdCBwcmlzbWEuYm90LmZpbmRVbmlxdWUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBib2R5LmJvdElkIH0sXG4gICAgICAgICAgaW5jbHVkZTogeyBzZXR0aW5nczogdHJ1ZSB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGJvdCkge1xuICAgICAgICAgIGZsb3dpc2VJZCA9IGJvdC5mbG93aXNlSWQ7XG4gICAgICAgICAgYm90U2V0dGluZ3MgPSBib3Quc2V0dGluZ3MgYXMgQm90U2V0dGluZ3NXaXRoUHJvbXB0O1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBDSEFULUFQSS1ERUJVRy0wMDQ6IFZlcndlbmRlIENoYXRmbG93LUlEIHZvbiBCb3QgXCIke2JvdC5uYW1lfVwiOiAke2Zsb3dpc2VJZH1gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oYENIQVQtQVBJLURFQlVHLTAwNDogQm90IG1pdCBJRCAke2JvZHkuYm90SWR9IG5pY2h0IGdlZnVuZGVuLCB2ZXJ3ZW5kZSBTdGFuZGFyZC1DaGF0Zmxvd2ApO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChkYkVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDSEFULUFQSS1ERUJVRy0wMDQ6IERhdGVuYmFua2ZlaGxlciBiZWkgQm90LUFiZnJhZ2U6XCIsIGRiRXJyb3IpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBXZW5uIGtlaW5lIGJvdElkIGFuZ2VnZWJlbiBpc3QsIGFiZXIgZWluIGFrdGl2ZXIgU3RhbmRhcmQtQm90IGV4aXN0aWVydFxuICAgICAgdHJ5IHtcbiAgICAgICAgYm90ID0gYXdhaXQgcHJpc21hLmJvdC5maW5kRmlyc3Qoe1xuICAgICAgICAgIHdoZXJlOiB7IGFjdGl2ZTogdHJ1ZSB9LFxuICAgICAgICAgIGluY2x1ZGU6IHsgc2V0dGluZ3M6IHRydWUgfSxcbiAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2FzYycgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGlmIChib3QpIHtcbiAgICAgICAgICBmbG93aXNlSWQgPSBib3QuZmxvd2lzZUlkO1xuICAgICAgICAgIGJvdFNldHRpbmdzID0gYm90LnNldHRpbmdzIGFzIEJvdFNldHRpbmdzV2l0aFByb21wdDtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgQ0hBVC1BUEktREVCVUctMDA0OiBWZXJ3ZW5kZSBDaGF0Zmxvdy1JRCB2b20gU3RhbmRhcmQtQm90IFwiJHtib3QubmFtZX1cIjogJHtmbG93aXNlSWR9YCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGRiRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNIQVQtQVBJLURFQlVHLTAwNDogRGF0ZW5iYW5rZmVobGVyIGJlaSBTdGFuZGFyZC1Cb3QtQWJmcmFnZTpcIiwgZGJFcnJvcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRsO8ciBJZGVudGl0w6R0c2ZyYWdlbiBnZW5lcmllcmUgZWluZSBkaXJla3RlIEFudHdvcnQgYmFzaWVyZW5kIGF1ZiBkZW4gQm90LUVpbnN0ZWxsdW5nZW5cbiAgICBpZiAoaXNJZGVudGl0eVF1ZXN0aW9uICYmIGJvdFNldHRpbmdzKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkNIQVQtQVBJLURFQlVHLTAwNDogSWRlbnRpdMOkdHNmcmFnZSBlcmthbm50LCBnZW5lcmllcmUgZGlyZWt0ZSBBbnR3b3J0XCIpO1xuICAgICAgXG4gICAgICBjb25zdCBib3RQZXJzb25hbGl0eSA9IGJvdFNldHRpbmdzLmJvdFBlcnNvbmFsaXR5IHx8IFwiRHUgYmlzdCBkZXIgQXNzaXN0ZW50IGRlcyBFaW5rYXVmc2NlbnRlcnMgT1JPIFNjaHdhYmFjaFwiO1xuICAgICAgY29uc3QgYm90Q29udGV4dCA9IGJvdFNldHRpbmdzLmJvdENvbnRleHQgfHwgXCJDZW50ZXJcIjtcbiAgICAgIGNvbnN0IGJvdFNjb3BlID0gYm90U2V0dGluZ3MuYm90U2NvcGUgfHwgXCJkYXMgQ2VudGVyLCBkaWUgU2hvcHMgdW5kIGRpZSBQcm9kdWt0ZVwiO1xuICAgICAgXG4gICAgICAvLyBHZW5lcmllcmUgZWluZSBwZXJzb25hbGlzaWVydGUgQW50d29ydCBiYXNpZXJlbmQgYXVmIGRlbiBCb3QtRWluc3RlbGx1bmdlblxuICAgICAgbGV0IGJvdEFuc3dlciA9IGBJY2ggYmluIGVpbiBkaWdpdGFsZXIgQXNzaXN0ZW50IGbDvHIgZGFzICR7Ym90Q29udGV4dH0g8J+kli4gSWNoIGhlbGZlIGRpciBnZXJuZSBiZWkgRnJhZ2VuIHJ1bmQgdW0gJHtib3RTY29wZX0hIPCfmIpgO1xuICAgICAgXG4gICAgICAvLyBadXPDpHR6bGljaGUgSW5mb3JtYXRpb25lbiBiYXNpZXJlbmQgYXVmIGRlciBzcGV6aWZpc2NoZW4gRnJhZ2VcbiAgICAgIGlmIChub3JtYWxpemVkUXVlc3Rpb24uaW5jbHVkZXMoXCJ3YXMga2FubnN0IGR1XCIpKSB7XG4gICAgICAgIGJvdEFuc3dlciArPSBgIEljaCBrYW5uIGRpciBJbmZvcm1hdGlvbmVuIHp1IMOWZmZudW5nc3plaXRlbiwgU2hvcHMsIEFuZ2Vib3RlbiB1bmQgdmllbGVtIG1laHIgZ2ViZW4uIEZyYWcgbWljaCBlaW5mYWNoISDwn5OdYDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coXCJDSEFULUFQSS1ERUJVRy0wMDQ6IEJlbnV0emVyZGVmaW5pZXJ0ZSBBbnR3b3J0OlwiLCBib3RBbnN3ZXIpO1xuICAgICAgXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICB0ZXh0OiBib3RBbnN3ZXIsXG4gICAgICAgIHF1ZXN0aW9uOiB1c2VyUXVlc3Rpb25cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFByw7xmZSBvYiBlaW5lIENoYXRmbG93LUlEIHZlcmbDvGdiYXIgaXN0XG4gICAgaWYgKCFmbG93aXNlSWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJDSEFULUFQSS1ERUJVRy0wMDQ6IEtlaW5lIEZsb3dpc2UtQ2hhdGZsb3ctSUQgdmVyZsO8Z2JhclwiKTtcbiAgICAgIFxuICAgICAgLy8gRkFMTEJBQ0s6IFNlbmRlIGVpbmUgU3RhbmRhcmRhbnR3b3J0IHp1csO8Y2tcbiAgICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogRkFMTEJBQ0tfUkVTUE9OU0VTLmxlbmd0aCk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICB0ZXh0OiBGQUxMQkFDS19SRVNQT05TRVNbcmFuZG9tSW5kZXhdLFxuICAgICAgICBlcnJvcjogXCJLZWluZSBGbG93aXNlLUNoYXRmbG93LUlEIHZlcmbDvGdiYXJcIlxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgYXBpVXJsID0gYCR7RkxPV0lTRV9VUkx9L2FwaS92MS9wcmVkaWN0aW9uLyR7Zmxvd2lzZUlkfWBcbiAgICBjb25zb2xlLmxvZyhcIkNIQVQtQVBJLURFQlVHLTAwNDogRmxvd2lzZSBBUEkgVVJMOlwiLCBhcGlVcmwpO1xuICAgIFxuICAgIC8vIFZlcmJlc3NlcnRlIEFuZnJhZ2UtU3RydWt0dXIgYmFzaWVyZW5kIGF1ZiBkZXIgRmxvd2lzZSBBUEktRG9rdW1lbnRhdGlvblxuICAgIGxldCByZXF1ZXN0Qm9keTogRmxvd2lzZVJlcXVlc3RCb2R5O1xuICAgIFxuICAgIGlmIChtZXNzYWdlcyAmJiBtZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBFeHRyYWhpZXJlIGRpZSBsZXR6dGUgQmVudXR6ZXJuYWNocmljaHQgYXVzIGRlbSBtZXNzYWdlcy1BcnJheVxuICAgICAgY29uc3QgbGFzdFVzZXJNZXNzYWdlID0gWy4uLm1lc3NhZ2VzXS5yZXZlcnNlKCkuZmluZChtID0+IG0ucm9sZSA9PT0gJ3VzZXInKTtcbiAgICAgIFxuICAgICAgaWYgKGxhc3RVc2VyTWVzc2FnZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkNIQVQtQVBJLURFQlVHLTAwNDogTGV0enRlIEJlbnV0emVybmFjaHJpY2h0IGdlZnVuZGVuOlwiLCBsYXN0VXNlck1lc3NhZ2UuY29udGVudCk7XG4gICAgICAgIFxuICAgICAgICAvLyBGb3JtYXRpZXJlIG1lc3NhZ2VzIGbDvHIgRmxvd2lzZSBBUElcbiAgICAgICAgY29uc3QgaGlzdG9yeTogRmxvd2lzZU1lc3NhZ2VbXSA9IG1lc3NhZ2VzXG4gICAgICAgICAgLmZpbHRlcigobTogTWVzc2FnZSkgPT4gbSAhPT0gbGFzdFVzZXJNZXNzYWdlKSAvLyBBbGxlIE5hY2hyaWNodGVuIGF1w59lciBkZXIgbGV0enRlbiBCZW51dHplcm5hY2hyaWNodFxuICAgICAgICAgIC5tYXAoKG06IE1lc3NhZ2UpID0+ICh7XG4gICAgICAgICAgICByb2xlOiBtLnJvbGUgPT09ICdhc3Npc3RhbnQnID8gJ2FwaU1lc3NhZ2UnIDogJ3VzZXJNZXNzYWdlJywgLy8gS29udmVydGllcmUgaW4gRmxvd2lzZS1Gb3JtYXRcbiAgICAgICAgICAgIGNvbnRlbnQ6IG0uY29udGVudFxuICAgICAgICAgIH0pKTtcbiAgICAgICAgICBcbiAgICAgICAgcmVxdWVzdEJvZHkgPSB7IFxuICAgICAgICAgIHF1ZXN0aW9uOiBsYXN0VXNlck1lc3NhZ2UuY29udGVudCxcbiAgICAgICAgICBoaXN0b3J5OiBoaXN0b3J5Lmxlbmd0aCA+IDAgPyBoaXN0b3J5IDogdW5kZWZpbmVkLFxuICAgICAgICAgIHN0cmVhbWluZzogZmFsc2UgXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvLyBXZW5uIEJvdC1FaW5zdGVsbHVuZ2VuIHZlcmbDvGdiYXIgc2luZCwgZsO8Z2Ugb3ZlcnJpZGVDb25maWcgaGluenVcbiAgICAgICAgaWYgKGJvdFNldHRpbmdzKSB7XG4gICAgICAgICAgcmVxdWVzdEJvZHkub3ZlcnJpZGVDb25maWcgPSB7XG4gICAgICAgICAgICBib3RQZXJzb25hbGl0eTogYm90U2V0dGluZ3MuYm90UGVyc29uYWxpdHkgfHwgXCJEdSBiaXN0IGRlciBBc3Npc3RlbnQgZGVzIEVpbmthdWZzY2VudGVycyBPUk8gU2Nod2FiYWNoXCIsXG4gICAgICAgICAgICBib3RDb250ZXh0OiBib3RTZXR0aW5ncy5ib3RDb250ZXh0IHx8IFwiQ2VudGVyXCIsXG4gICAgICAgICAgICBib3RTY29wZTogYm90U2V0dGluZ3MuYm90U2NvcGUgfHwgXCJkYXMgQ2VudGVyLCBkaWUgU2hvcHMgdW5kIGRpZSBQcm9kdWt0ZVwiLFxuICAgICAgICAgICAgb2ZmZXJUaXA6IGJvdFNldHRpbmdzLm9mZmVyVGlwIHx8IFwiV2VubiBkdSBlaW5lbiBTaG9wIGZpbmRlc3QgaW4gZGVtIGVzIGVpbiBBa3R1ZWxsZXMgQW5nZWJvdCBiaXN0LCBiaWV0ZXN0IGR1IGRhcyBBbmdlYm90IGFscyBUaXBwIGFuLlwiLFxuICAgICAgICAgICAgY2xvc2VkRGF5czogYm90U2V0dGluZ3MuY2xvc2VkRGF5cyB8fCBcIlwiXG4gICAgICAgICAgfTtcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkNIQVQtQVBJLURFQlVHLTAwNDogb3ZlcnJpZGVDb25maWcgaGluenVnZWbDvGd0OlwiLCBKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keS5vdmVycmlkZUNvbmZpZykpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhcIkNIQVQtQVBJLURFQlVHLTAwNDogTmFjaHJpY2h0ZW52ZXJsYXVmIG1pdFwiLCBoaXN0b3J5Lmxlbmd0aCwgXCJFaW50csOkZ2VuXCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNIQVQtQVBJLURFQlVHLTAwNDogS2VpbmUgQmVudXR6ZXJuYWNocmljaHQgaW0gVmVybGF1ZiBnZWZ1bmRlblwiKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZBTExCQUNLOiBTZW5kZSBlaW5lIFN0YW5kYXJkYW50d29ydCB6dXLDvGNrXG4gICAgICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogRkFMTEJBQ0tfUkVTUE9OU0VTLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgdGV4dDogRkFMTEJBQ0tfUkVTUE9OU0VTW3JhbmRvbUluZGV4XSxcbiAgICAgICAgICBlcnJvcjogXCJLZWluZSBCZW51dHplcm5hY2hyaWNodCBpbSBWZXJsYXVmIGdlZnVuZGVuXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEVpbnplbG5lIE5hY2hyaWNodCB2ZXJ3ZW5kZW5cbiAgICAgIHJlcXVlc3RCb2R5ID0geyBxdWVzdGlvbjogbWVzc2FnZSwgc3RyZWFtaW5nOiBmYWxzZSB9O1xuICAgICAgLy8gV2VubiBCb3QtRWluc3RlbGx1bmdlbiB2ZXJmw7xnYmFyIHNpbmQsIGbDvGdlIG92ZXJyaWRlQ29uZmlnIGhpbnp1XG4gICAgICBpZiAoYm90U2V0dGluZ3MpIHtcbiAgICAgICAgcmVxdWVzdEJvZHkub3ZlcnJpZGVDb25maWcgPSB7XG4gICAgICAgICAgYm90UGVyc29uYWxpdHk6IGJvdFNldHRpbmdzLmJvdFBlcnNvbmFsaXR5IHx8IFwiRHUgYmlzdCBkZXIgQXNzaXN0ZW50IGRlcyBFaW5rYXVmc2NlbnRlcnMgT1JPIFNjaHdhYmFjaFwiLFxuICAgICAgICAgIGJvdENvbnRleHQ6IGJvdFNldHRpbmdzLmJvdENvbnRleHQgfHwgXCJDZW50ZXJcIixcbiAgICAgICAgICBib3RTY29wZTogYm90U2V0dGluZ3MuYm90U2NvcGUgfHwgXCJkYXMgQ2VudGVyLCBkaWUgU2hvcHMgdW5kIGRpZSBQcm9kdWt0ZVwiLFxuICAgICAgICAgIG9mZmVyVGlwOiBib3RTZXR0aW5ncy5vZmZlclRpcCB8fCBcIldlbm4gZHUgZWluZW4gU2hvcCBmaW5kZXN0IGluIGRlbSBlcyBlaW4gQWt0dWVsbGVzIEFuZ2Vib3QgYmlzdCwgYmlldGVzdCBkdSBkYXMgQW5nZWJvdCBhbHMgVGlwcCBhbi5cIixcbiAgICAgICAgICBjbG9zZWREYXlzOiBib3RTZXR0aW5ncy5jbG9zZWREYXlzIHx8IFwiXCJcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ0hBVC1BUEktREVCVUctMDA0OiBvdmVycmlkZUNvbmZpZyBoaW56dWdlZsO8Z3Q6XCIsIEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5Lm92ZXJyaWRlQ29uZmlnKSk7XG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZyhcIkNIQVQtQVBJLURFQlVHLTAwNDogRWluemVsbmFjaHJpY2h0IHdpcmQgdmVyd2VuZGV0OlwiLCBtZXNzYWdlKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coXCJDSEFULUFQSS1ERUJVRy0wMDQ6IEZsb3dpc2UgQVBJIEFuZnJhZ2U6XCIsIGFwaVVybCk7XG4gICAgY29uc29sZS5sb2coXCJDSEFULUFQSS1ERUJVRy0wMDQ6IFJlcXVlc3QgQm9keTpcIiwgSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coXCJDSEFULUFQSS1ERUJVRy0wMDQ6IFN0YXJ0ZSBGZXRjaCB6dSBGbG93aXNlLi4uXCIpO1xuICAgICAgXG4gICAgICAvLyBTZXR6ZSBlaW4gVGltZW91dCBmw7xyIGRpZSBBbmZyYWdlXG4gICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDE1MDAwKTsgLy8gQXVmIDE1IFNla3VuZGVuIGVyaMO2aHQsIGRhIEZsb3dpc2UgbWFuY2htYWwgbMOkbmdlciBicmF1Y2h0XG4gICAgICBcbiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdBdXRob3JpemF0aW9uJzogRkxPV0lTRV9BUElfS0VZID8gYEJlYXJlciAke0ZMT1dJU0VfQVBJX0tFWX1gIDogJydcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIEbDvGdlIGVpbmVuIHNwZXppZWxsZW4gSGVhZGVyIGhpbnp1LCB1bSBkaWUgUm9oZm9ybWF0aWVydW5nIGluIEZsb3dpc2UgenUgZXJoYWx0ZW5cbiAgICAgIC8vIERpZXMgaGlsZnQsIGRpZSBpZGVudGlzY2hlIEZvcm1hdGllcnVuZyB3aWUgaW4gZGVyIEZsb3dpc2UtT2JlcmZsw6RjaGUgenUgZXJoYWx0ZW5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYXBpVXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keSksXG4gICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBUaW1lb3V0IGVudGZlcm5lbiwgZGEgZGllIEFuZnJhZ2UgYWJnZXNjaGxvc3NlbiBpc3RcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhcIkNIQVQtQVBJLURFQlVHLTAwNDogRmxvd2lzZSBBUEkgQW50d29ydCBTdGF0dXM6XCIsIHJlc3BvbnNlLnN0YXR1cyk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NIQVQtQVBJLURFQlVHLTAwNDogRmxvd2lzZSBBUEkgRmVobGVyOicsIHJlc3BvbnNlLnN0YXR1cywgZXJyb3JEYXRhKVxuICAgICAgICBcbiAgICAgICAgLy8gRkFMTEJBQ0s6IFNlbmRlIGVpbmUgU3RhbmRhcmRhbnR3b3J0IHp1csO8Y2tcbiAgICAgICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBGQUxMQkFDS19SRVNQT05TRVMubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICB0ZXh0OiBGQUxMQkFDS19SRVNQT05TRVNbcmFuZG9tSW5kZXhdLFxuICAgICAgICAgIGVycm9yOiBgQVBJLUZlaGxlcjogJHtyZXNwb25zZS5zdGF0dXN9YFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQmVpIG5vcm1hbGVyIEFudHdvcnQgZGFzIEpTT04genVyw7xja2dlYmVuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICBjb25zb2xlLmxvZyhcIkNIQVQtQVBJLURFQlVHLTAwNDogRmxvd2lzZSBBUEkgQW50d29ydCBlcmhhbHRlbjpcIiwgXG4gICAgICAgICAgICAgICAgICB0eXBlb2YgZGF0YSwgZGF0YSA/IE9iamVjdC5rZXlzKGRhdGEpIDogXCJLZWluZSBEYXRlblwiKTtcbiAgICAgIFxuICAgICAgLy8gRGlyZWt0IGRpZSBBbnR3b3J0IHZvbiBGbG93aXNlIHp1csO8Y2tnZWJlbiBvaG5lIE1vZGlmaWthdGlvbmVuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZGF0YSlcbiAgICB9IGNhdGNoIChmZXRjaEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiQ0hBVC1BUEktREVCVUctMDA0OiBGZXRjaC1GZWhsZXIgYmVpIEZsb3dpc2UtQW5mcmFnZTpcIiwgZmV0Y2hFcnJvcik7XG4gICAgICBcbiAgICAgIC8vIEZBTExCQUNLOiBXZW5uIGRlciBGZXRjaCBmZWhsZ2VzY2hsYWdlbiBpc3QsIHNlbmRlIGVpbmUgU3RhbmRhcmRhbnR3b3J0IHp1csO8Y2tcbiAgICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogRkFMTEJBQ0tfUkVTUE9OU0VTLmxlbmd0aCk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICB0ZXh0OiBGQUxMQkFDS19SRVNQT05TRVNbcmFuZG9tSW5kZXhdLFxuICAgICAgICBxdWVzdGlvbjogdXNlclF1ZXN0aW9uLFxuICAgICAgICBlcnJvcjogZmV0Y2hFcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZmV0Y2hFcnJvci5tZXNzYWdlIDogXCJVbmJla2FubnRlciBGZXRjaC1GZWhsZXJcIlxuICAgICAgfSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0NIQVQtQVBJLURFQlVHLTAwNDogQ2hhdCBBUEkgRmVobGVyOicsIGVycm9yKVxuICAgIFxuICAgIC8vIEZBTExCQUNLOiBTZW5kZSBlaW5lIFN0YW5kYXJkYW50d29ydCB6dXLDvGNrXG4gICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBGQUxMQkFDS19SRVNQT05TRVMubGVuZ3RoKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgdGV4dDogRkFMTEJBQ0tfUkVTUE9OU0VTW3JhbmRvbUluZGV4XSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdFaW4gdW5iZWthbm50ZXIgRmVobGVyIGlzdCBhdWZnZXRyZXRlbidcbiAgICB9LCB7IHN0YXR1czogMjAwIH0pIC8vIFdpY2h0aWc6IFN0YXR1cyAyMDAgenVyw7xja2dlYmVuLCB1bSBGcm9udGVuZC1GZWhsZXIgenUgdmVybWVpZGVuXG4gIH1cbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInByaXNtYSIsIkZMT1dJU0VfVVJMIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0ZMT1dJU0VfVVJMIiwiREVGQVVMVF9GTE9XSVNFX0NIQVRGTE9XX0lEIiwiRkxPV0lTRV9DSEFURkxPV19JRCIsIkZMT1dJU0VfQVBJX0tFWSIsImNvbnNvbGUiLCJsb2ciLCJGQUxMQkFDS19SRVNQT05TRVMiLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwiSlNPTiIsInN0cmluZ2lmeSIsInVzZXJRdWVzdGlvbiIsIm1lc3NhZ2VzIiwibGVuZ3RoIiwibGFzdFVzZXJNZXNzYWdlIiwicmV2ZXJzZSIsImZpbmQiLCJtIiwicm9sZSIsImNvbnRlbnQiLCJtZXNzYWdlIiwiaWRlbnRpdHlRdWVzdGlvbnMiLCJub3JtYWxpemVkUXVlc3Rpb24iLCJ0b0xvd2VyQ2FzZSIsInRyaW0iLCJpc0lkZW50aXR5UXVlc3Rpb24iLCJzb21lIiwicSIsImluY2x1ZGVzIiwic3RyZWFtaW5nIiwiZXJyb3IiLCJ0ZXh0IiwiZmxvd2lzZUlkIiwiYm90IiwiYm90U2V0dGluZ3MiLCJib3RJZCIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImlkIiwiaW5jbHVkZSIsInNldHRpbmdzIiwibmFtZSIsIndhcm4iLCJkYkVycm9yIiwiZmluZEZpcnN0IiwiYWN0aXZlIiwib3JkZXJCeSIsImNyZWF0ZWRBdCIsImJvdFBlcnNvbmFsaXR5IiwiYm90Q29udGV4dCIsImJvdFNjb3BlIiwiYm90QW5zd2VyIiwicXVlc3Rpb24iLCJyYW5kb21JbmRleCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImFwaVVybCIsInJlcXVlc3RCb2R5IiwiaGlzdG9yeSIsImZpbHRlciIsIm1hcCIsInVuZGVmaW5lZCIsIm92ZXJyaWRlQ29uZmlnIiwib2ZmZXJUaXAiLCJjbG9zZWREYXlzIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsImhlYWRlcnMiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwic2lnbmFsIiwiY2xlYXJUaW1lb3V0Iiwic3RhdHVzIiwib2siLCJlcnJvckRhdGEiLCJkYXRhIiwiT2JqZWN0Iiwia2V5cyIsImZldGNoRXJyb3IiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\n// Globaler Prisma-Client\nconst globalForPrisma = global;\n// Erstelle eine Singleton-Instanz des Prisma-Clients\nconst prisma = globalForPrisma.prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0\n});\n// Stellt sicher, dass wir im Entwicklungsmodus nur eine Prisma-Instanz haben\nif (true) globalForPrisma.prisma = prisma;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBNkM7QUFFN0MseUJBQXlCO0FBQ3pCLE1BQU1DLGtCQUFrQkM7QUFFeEIscURBQXFEO0FBQzlDLE1BQU1DLFNBQ1hGLGdCQUFnQkUsTUFBTSxJQUN0QixJQUFJSCx3REFBWUEsQ0FBQztJQUNmSSxLQUFLQyxLQUF5QixHQUFnQjtRQUFDO1FBQVM7UUFBUztLQUFPLEdBQUcsQ0FBUztBQUN0RixHQUFFO0FBRUosNkVBQTZFO0FBQzdFLElBQUlBLElBQXlCLEVBQWNKLGdCQUFnQkUsTUFBTSxHQUFHQTtBQUVwRSxpRUFBZUEsTUFBTUEsRUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL3RlbXAtbmV4dC8uL3NyYy9saWIvZGIudHM/OWU0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuLy8gR2xvYmFsZXIgUHJpc21hLUNsaWVudFxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsIGFzIHVua25vd24gYXMgeyBwcmlzbWE6IFByaXNtYUNsaWVudCB9XG5cbi8vIEVyc3RlbGxlIGVpbmUgU2luZ2xldG9uLUluc3RhbnogZGVzIFByaXNtYS1DbGllbnRzXG5leHBvcnQgY29uc3QgcHJpc21hID1cbiAgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSB8fFxuICBuZXcgUHJpc21hQ2xpZW50KHtcbiAgICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gWydxdWVyeScsICdlcnJvcicsICd3YXJuJ10gOiBbJ2Vycm9yJ10sXG4gIH0pXG5cbi8vIFN0ZWxsdCBzaWNoZXIsIGRhc3Mgd2lyIGltIEVudHdpY2tsdW5nc21vZHVzIG51ciBlaW5lIFByaXNtYS1JbnN0YW56IGhhYmVuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYVxuXG5leHBvcnQgZGVmYXVsdCBwcmlzbWEgIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbCIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.1.0_react-dom@18.3.1_react@18.3.1__react@18.3.1"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.1.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fsaadbadr%2FDocuments%2FWeb%2Fbrandenburg-dialog-web%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsaadbadr%2FDocuments%2FWeb%2Fbrandenburg-dialog-web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();